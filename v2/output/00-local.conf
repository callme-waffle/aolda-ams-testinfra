# Local file output for HAProxy logs (syslog.local1.**)
<match syslog.local1.**>
  @type copy
  <store>
    @type file
    path /var/log/kolla/haproxy/haproxy_latest
    append true
    <buffer []>
      path /var/log/kolla/haproxy/haproxy_latest.*.buffer
    </buffer>
    <format>
      output_tag false
      output_time false
    </format>
  </store>
  <store>
    @type loki
    url http://192.168.1.13:3100
    <label>
      type ${record["type"]}
      level ${record["level"]}
      source ${record["source"]}
    </label>
    <buffer>
      @type file
      path /var/lib/fluentd/buffer/loki/local1
      flush_interval 10s
      chunk_limit_size 1M
      retry_max_times 3
    </buffer>
  </store>
</match>
