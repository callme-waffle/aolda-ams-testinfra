# Loki output for all logs
# Matches final tags after filtering:
# - apache_access, wsgi_access, openstack_python (from kolla.*)
# - infra.mariadb.mysqld, infra.mariadb.mysqld_safe (from infra.mariadb)
# - infra.rabbit, infra.libvirt, infra.openvswitch, infra.openvswitchdb, infra.redis, infra.redis-sentinel
# - syslog.** (from syslog)
# - fluent.journal.* (from journal)
<match apache_access wsgi_access openstack_python infra.** syslog.** fluent.journal.**>
  @type loki
  url http://192.168.1.13:3100
  <label>
    type   type
    level  level
    source source
    # (선택) 호스트명도 라벨로 있으면 편합니다.
    host   Hostname
  </label>
  <buffer>
    @type file
    path /var/lib/fluentd/buffer/loki
    flush_interval 10s
    chunk_limit_size 1M
    retry_max_times 3
  </buffer>
  # 데이터를 JSON 형식으로 전송
  <format>
    @type json
  </format>
</match>
